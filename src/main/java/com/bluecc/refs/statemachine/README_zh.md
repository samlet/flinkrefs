示例：运行状态机以进行模式检测
此示例使用在流上评估的简单状态机说明了一个最小的自己动手事件模式检测场景。

虽然这个示例比 CEP 库支持的更简单和更手动，但它说明了事件处理和状态管理在中等复杂场景中的使用。

场景描述

流中的事件预计会以某些模式发生。与这些模式的任何偏差都表明流媒体系统应识别出异常并应触发警报。

例如，您可以将事件视为由网络设备和服务生成，例如防火墙登录和注册身份验证服务等。与预期模式的偏差可能表示入侵检测。

每个交互方都跟踪事件模式（这里简化了每个源 IP 地址）并由状态机验证。状态机的状态定义了接下来可能发生的事件，以及这些事件将导致的新状态。

下图描述了本示例中使用的状态机。

           +--<a>--> W --<b>--> Y --<e>---+
           |                    ^         |
INITIAL-+                    |         |
|                    |         +--> (Z) -----<g>---> TERM
+--<c>--> X --<b>----+         |
|                    |
+--------<d>---------+
示例程序

这个示例程序的主类是com.bluecc.refs.statemachine.StateMachineExample. 核心逻辑在flatMap函数中，它运行每个 IP 地址的状态机。

流数据流如下所示，其中源流可能来自嵌入式数据生成器，也可能来自 Kafka 主题：

[ stream partition 1] --> source --> partition -+---> flatMap(state machine) --> sink
\/
/\
[ stream partition 2] --> source --> partition -+---> flatMap(state machine) --> sink
